<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Salient Object Detection</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        /* Base Styles */
        :root {
          --background: #0d1117;
          --foreground: #c9d1d9;
          --primary: #00e6ac;
          --primary-hover: #00b386;
          --card: #21262d;
          --card-foreground: #c9d1d9;
          --muted: #30363d;
          --muted-foreground: #8b949e;
          --header: #161b22;
        }

        body {
          font-family: "Arial", sans-serif;
          margin: 0;
          padding: 0;
          /* Professional, advanced multi-color animated gradient background */
          background: linear-gradient(120deg, #1a223f 0%, #283e51 40%, #485563 70%, #6a11cb 90%, #2575fc 100%);
          color: var(--foreground);
          position: relative;
          overflow-x: hidden;
        }



        .upload-container {
  text-align: center;
  max-width: 400px;
  width: 100%;
  padding: 20px;
  border-radius: 16px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  background-color: rgba(255, 255, 255, 0.1);
}

.drop-zone {
  position: relative;
  width: 100%;
  height: 200px;
  border: 2px dashed #00FFB3;
  border-radius: 16px;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.drop-zone:hover {
  background-color: rgba(0, 255, 179, 0.1);
}

.placeholder {
  text-align: center;
  color: #aaa;
}

.placeholder i {
  font-size: 48px;
  margin-bottom: 10px;
}

.placeholder p {
  font-size: 18px;
  margin-bottom: 5px;
}

.placeholder small {
  font-size: 12px;
}

.upload-btn {
  margin-top: 20px;
  padding: 10px 20px;
  font-size: 16px;
  font-weight: 500;
  color: #121212;
  background-color: #00FFB3;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.upload-btn:hover {
  background-color: #00E67F;
}

.upload-btn:active {
  transform: scale(0.98);
}

        /* Animated abstract overlay with professional accent colors */
        body::before {
          content: '';
          position: fixed;
          top: 0; left: 0; right: 0; bottom: 0;
          z-index: 0;
          pointer-events: none;
          background:
            radial-gradient(circle at 20% 30%, rgba(39,174,96,0.10) 0%, transparent 60%), /* teal accent */
            radial-gradient(circle at 80% 70%, rgba(241,196,15,0.09) 0%, transparent 60%), /* gold accent */
            radial-gradient(circle at 60% 20%, rgba(106,17,203,0.10) 0%, transparent 60%), /* purple accent */
            radial-gradient(circle at 50% 100%, rgba(37,117,252,0.07) 0%, transparent 70%), /* blue accent */
            linear-gradient(120deg, rgba(26,34,63,0.07) 0%, rgba(106,17,203,0.07) 100%);
          animation: bgMovePro 22s linear infinite alternate;
        }

        @keyframes bgMovePro {
          0% {
            background-position:
              20% 30%,
              80% 70%,
              60% 20%,
              50% 100%,
              0% 0%;
          }
          100% {
            background-position:
              30% 40%,
              70% 60%,
              50% 30%,
              60% 90%,
              100% 100%;
          }
        }

        /* Header Styles */
        header {
          background-color: var(--header);
          padding: 20px 40px;
          position: fixed;
          width: 100%;
          top: 0;
          z-index: 1000;
          box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
          box-sizing: border-box;
        }

        .header-content {
          display: flex;
          justify-content: space-between;
          align-items: center;
          max-width: 1200px;
          margin: 0 auto;
        }

        .logo {
          font-size: 1.5rem;
          color: var(--primary);
          font-weight: bold;
        }

        .nav {
          list-style-type: none;
          display: flex;
          margin: 0;
          padding: 0;
        }

        .nav li {
          margin-left: 20px;
        }

        .nav a {
          text-decoration: none;
          color: var(--foreground);
          font-size: 1rem;
          padding: 10px 20px;
          border-radius: 30px;
          transition: all 0.3s ease-in-out;
        }

        .nav a:hover,
        .nav a.active {
          background: var(--primary);
          color: var(--background);
          box-shadow: 0px 0px 10px var(--primary);
        }

        /* Section Styles */
        .section {
          padding-top: 60px; /* Reduced from 100px to 60px */
          min-height: 100vh;
        }

        /* Hero Section */
        .hero {
          display: flex;
          min-height: 100vh;
          padding-top: 80px;
        }

        .hero-content {
          flex: 1;
          display: flex;
          flex-direction: column;
          justify-content: center;
          padding: 60px;
          max-width: 50%;
        }

        .hero-images {
          flex: 1;
          display: flex;
          justify-content: center;
          align-items: center;
          gap: 20px;
          padding: 20px;
        }

        .hero-image {
          width: 30%;
          height: 400px;
          position: relative;
          overflow: hidden;
          border-radius: 10px;
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .hero-image img {
          width: 100%;
          height: 100%;
          object-fit: cover;
          transition: transform 0.3s ease;
        }

        .hero-image:hover img {
          transform: scale(1.05);
        }

        .hero-image-overlay {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: linear-gradient(135deg, rgba(13, 17, 23, 0.8) 0%, rgba(13, 17, 23, 0) 100%);
        }

        .hero h1 {
          font-size: 3.5rem;
          margin-bottom: 20px;
          line-height: 1.2;
        }

        .hero h1 span {
          color: var(--primary);
          display: block;
        }

        .hero p {
          font-size: 1.2rem;
          color: var(--muted-foreground);
          margin-bottom: 30px;
          line-height: 1.6;
        }

        .hero-buttons {
          display: flex;
          gap: 20px;
        }

        .button {
          display: inline-block;
          padding: 15px 30px;
          border-radius: 8px;
          font-size: 1.1rem;
          font-weight: bold;
          text-decoration: none;
          transition: all 0.3s ease;
        }

        .button-primary {
          background-color: var(--primary);
          color: var(--background);
        }

        .button-primary:hover {
          transform: translateY(-2px);
          box-shadow: 0 5px 15px rgba(0, 230, 172, 0.4);
        }

        .button-secondary {
          background-color: transparent;
          color: var(--primary);
          border: 2px solid var(--primary);
        }

        .button-secondary:hover {
          background-color: var(--primary);
          color: var(--background);
        }

        /* Container and Panel Styles */
        .container {
          max-width: 1200px;
          margin: 40px auto;
          padding: 20px;
        }

        .panel {
          background-color: var(--card);
          border-radius: 12px;
          box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
          padding: 30px;
          margin-bottom: 30px;
        }

        .panel h2 {
          color: var(--primary);
          font-size: 1.8rem;
          margin-bottom: 20px;
          text-align: center;
        }

        /* Upload Form Styles */
        #uploadForm {
          display: flex;
          flex-direction: column;
          align-items: center;
        }

        .file-upload {
          width: 100%;
          max-width: 400px;
          margin-bottom: 20px;
        }

        .file-upload input[type="file"] {
          display: none;
        }

        .file-upload label {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          padding: 30px;
          border: 2px dashed var(--muted);
          border-radius: 10px;
          cursor: pointer;
          transition: all 0.3s ease;
        }

        .file-upload label:hover {
          border-color: var(--primary);
          background-color: rgba(0, 230, 172, 0.05);
        }

        .upload-icon {
          color: var(--primary);
          margin-bottom: 15px;
          font-size: 2rem;
        }

        #file-name {
          font-size: 1.1rem;
          margin-bottom: 5px;
        }

        #file-size {
          font-size: 0.9rem;
          color: var(--muted-foreground);
        }

        #uploadButton {
          background-color: var(--primary);
          color: var(--background);
          border: none;
          padding: 12px 24px;
          border-radius: 8px;
          cursor: pointer;
          font-size: 18px;
          font-weight: bold;
          transition: background-color 0.3s, transform 0.2s;
        }

        #uploadButton:hover {
          background-color: var(--primary-hover);
          transform: scale(1.05);
        }

        /* Results Styles */
        #results {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
          gap: 20px;
        }

        .result-item {
          background-color: var(--muted);
          border-radius: 10px;
          padding: 20px;
          text-align: center;
        }

        .result-item h3 {
          color: var(--primary);
          margin-bottom: 15px;
        }

        .result-item img {
          max-width: 100%;
          border-radius: 8px;
          border: 2px solid var(--primary);
        }

        /* About Page Styles */
        .about-content {
          max-width: 800px;
          margin: 0 auto;
        }

        .about-section {
          margin-bottom: 30px;
        }

        .about-section h3 {
          color: var(--primary);
          font-size: 1.3rem;
          margin-bottom: 15px;
        }

        .about-section p {
          margin-bottom: 15px;
          line-height: 1.6;
        }

        .about-list {
          list-style-type: disc;
          padding-left: 20px;
          margin-top: 10px;
        }

        .about-list li {
          margin-bottom: 8px;
          line-height: 1.5;
        }

        /* Payment Page Styles */
        .payment-content {
          max-width: 1000px;
          margin: 0 auto;
        }

        .payment-intro {
          text-align: center;
          margin-bottom: 30px;
          font-size: 1.1rem;
        }

        .pricing-plans {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
          gap: 20px;
          margin-bottom: 40px;
        }

        .pricing-card {
          background-color: var(--muted);
          border-radius: 10px;
          padding: 25px;
          border: 2px solid var(--muted);
          transition: border-color 0.3s, box-shadow 0.3s;
          position: relative;
        }

        .pricing-card:hover {
          border-color: var(--primary);
        }

        .pricing-card.popular {
          border-color: var(--primary);
          box-shadow: 0 0 15px rgba(0, 230, 172, 0.3);
        }

        .popular-badge {
          position: absolute;
          top: -10px;
          left: 50%;
          transform: translateX(-50%);
          background-color: var(--primary);
          color: var(--background);
          font-size: 0.8rem;
          font-weight: bold;
          padding: 5px 10px;
          border-radius: 20px;
        }

        .pricing-header {
          text-align: center;
          margin-bottom: 20px;
          padding-top: 10px;
        }

        .pricing-header h3 {
          color: var(--primary);
          font-size: 1.5rem;
          margin-bottom: 10px;
        }

        .pricing-price {
          margin-top: 10px;
        }

        .price {
          font-size: 2rem;
          font-weight: bold;
        }

        .period {
          color: var(--muted-foreground);
        }

        .pricing-features {
          list-style-type: none;
          padding: 0;
          margin: 0 0 25px 0;
        }

        .pricing-features li {
          display: flex;
          align-items: center;
          margin-bottom: 12px;
        }

        .pricing-features li::before {
          content: "✓";
          color: var(--primary);
          margin-right: 10px;
          font-weight: bold;
        }

        .pricing-button {
          width: 100%;
          padding: 10px;
          border-radius: 8px;
          font-weight: bold;
          cursor: pointer;
          transition: all 0.3s ease;
        }

        .pricing-button.primary {
          background-color: var(--primary);
          color: var(--background);
          border: none;
        }

        .pricing-button.primary:hover {
          background-color: var(--primary-hover);
        }

        .pricing-button:not(.primary) {
          background-color: transparent;
          border: 2px solid var(--primary);
          color: var(--primary);
        }

        .pricing-button:not(.primary):hover {
          background-color: var(--primary);
          color: var(--background);
        }

        /* Feedback Page Styles */
        .feedback-content {
          max-width: 700px;
          margin: 0 auto;
        }

        .feedback-intro {
          text-align: center;
          margin-bottom: 30px;
          font-size: 1.1rem;
        }

        .feedback-form {
          margin-bottom: 30px;
        }

        .form-group {
          text-align: center;
          margin-bottom: 25px;
          position: relative;
        }

        .form-group label {
          display: block;
          margin-bottom: 8px;
          font-weight: bold;
          color: var(--foreground);
          font-size: 1rem;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
          width: 100%;
          padding: 15px;
          background-color: var(--muted);
          border: 2px solid var(--muted);
          border-radius: 10px;
          color: var(--foreground);
          font-size: 1rem;
          box-sizing: border-box;
          transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 3px rgba(0, 230, 172, 0.1);
          background-color: rgba(0, 230, 172, 0.05);
        }

        .form-group input::placeholder {
          color: var(--muted-foreground);
        }

        .rating {
          display: flex;
          justify-content: center;
          gap: 10px;
        }

        .star-btn {
          background: none;
          border: none;
          cursor: pointer;
          padding: 0;
          color: var(--muted-foreground);
          transition: color 0.2s, transform 0.2s;
          font-size: 2rem;
        }

        .star-btn:hover,
        .star-btn.active {
          color: var(--primary);
          transform: scale(1.1);
        }

        .form-submit {
          text-align: center;
          margin-top: 30px;
        }

        .submit-button {
          background-color: var(--primary);
          color: var(--background);
          border: none;
          padding: 12px 30px;
          border-radius: 8px;
          font-size: 1.1rem;
          font-weight: bold;
          cursor: pointer;
          transition: background-color 0.3s, transform 0.2s;
        }

        .submit-button:hover {
          background-color: var(--primary-hover);
          transform: scale(1.05);
        }

        /* Footer Styles */
        footer {
          background-color: var(--header);
          padding: 50px 0 20px;
          margin-top: 50px;
        }

        .footer-content {
          max-width: 1200px;
          margin: 0 auto;
          padding: 0 20px;
        }

        .footer-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 30px;
          margin-top: 40px;
        }

        .footer-section h3 {
          color: var(--primary);
          font-size: 1.3rem;
          margin-bottom: 15px;
        }

        .footer-section h4 {
          color: var(--foreground);
          font-size: 1.1rem;
          margin-bottom: 15px;
        }

        .footer-section p {
          color: var(--muted-foreground);
          line-height: 1.5;
          margin-bottom: 15px;
        }

        .footer-section ul {
          list-style-type: none;
          padding: 0;
          margin: 0;
        }

        .footer-section ul li {
          margin-bottom: 10px;
        }

        .footer-section ul li a {
          color: var(--muted-foreground);
          text-decoration: none;
          transition: color 0.3s;
        }

        .footer-section ul li a:hover {
          color: var(--primary);
        }

        .footer-bottom {
          text-align: center;
          padding-top: 20px;
          border-top: 1px solid var(--muted);
          color: var(--muted-foreground);
          font-size: 0.9rem;
        }

        /* Progress and Loading Styles */
        .progress-container {
          width: 100%;
          max-width: 400px;
          background-color: var(--muted);
          border-radius: 10px;
          margin: 20px auto;
          overflow: hidden;
          box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
        }

        .progress-bar {
          width: 0;
          height: 20px;
          background-color: var(--primary);
          text-align: center;
          line-height: 20px;
          color: var(--background);
          font-weight: bold;
          border-radius: 10px;
          transition: width 0.3s ease-in-out;
        }

        #statusMessage {
          text-align: center;
          font-size: 14px;
          margin-top: 10px;
          font-weight: bold;
          color: var(--primary);
        }

        .loading-overlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(13, 17, 23, 0.8);
          display: flex;
          flex-direction: column;
          justify-content: center;
          align-items: center;
          z-index: 2000;
          opacity: 0;
          visibility: hidden;
          transition: opacity 0.3s, visibility 0.3s;
        }

        .loading-overlay.active {
          opacity: 1;
          visibility: visible;
        }

        .spinner {
          width: 60px;
          height: 60px;
          border: 5px solid var(--muted);
          border-top: 5px solid var(--primary);
          border-radius: 50%;
          animation: spin 1s linear infinite;
        }

        .loading-text {
          margin-top: 20px;
          color: var(--primary);
          font-size: 1.2rem;
          text-align: center;
        }

        .view-btn {
          background-color: #00e6ac;
          color: white;
          padding: 12px 24px;
          font-size: 16px;
          border: none;
          border-radius: 8px;
          cursor: pointer;
          transition: background-color 0.3s ease, transform 0.2s ease;
        }

        .view-btn:hover {
          background-color: #00b386;
          transform: scale(1.05);
        }

        .view-btn:active {
          transform: scale(1);
        }

        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }

        /* Plan Type Cards */
        .plan-selection {
          display: grid;
          grid-template-columns: 1fr;
          gap: 15px;
          margin-top: 10px;
        }

        .plan-card {
          background-color: var(--muted);
          border: 2px solid var(--muted);
          border-radius: 10px;
          padding: 20px;
          text-align: center;
          cursor: pointer;
          transition: all 0.3s ease;
          position: relative;
        }

        .plan-card:hover {
          border-color: var(--primary);
          transform: translateY(-2px);
          box-shadow: 0 5px 15px rgba(0, 230, 172, 0.2);
        }

        .plan-card.selected {
          border-color: var(--primary);
          background-color: rgba(0, 230, 172, 0.1);
        }

        .plan-card input[type="radio"] {
          display: none;
        }

        .plan-icon {
          font-size: 2rem;
          margin-bottom: 10px;
          display: block;
        }

        .plan-name {
          font-weight: bold;
          color: var(--primary);
          margin-bottom: 5px;
        }

        .plan-price {
          color: var(--muted-foreground);
          font-size: 0.9rem;
        }

        /* Download Section Styles */
        .download-section {
          background-color: var(--header);
          padding: 30px 0;
          margin-top: 50px;
        }

        .download-panel {
          max-width: 1200px;
          margin: 0 auto;
          padding: 0 20px;
          text-align: center;
        }

        .download-panel h3 {
          color: var(--primary);
          font-size: 1.5rem;
          margin-bottom: 20px;
        }

        .download-options {
          display: flex;
          justify-content: center;
          gap: 15px;
          flex-wrap: wrap;
        }

        .download-btn {
          background-color: var(--primary);
          color: var(--background);
          border: none;
          padding: 12px 25px;
          border-radius: 8px;
          font-size: 1rem;
          font-weight: bold;
          cursor: pointer;
          transition: all 0.3s ease;
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .download-btn:hover {
          background-color: var(--primary-hover);
          transform: translateY(-2px);
          box-shadow: 0 5px 15px rgba(0, 230, 172, 0.4);
        }

        .download-btn:active {
          transform: translateY(0);
        }

        .feedback-btn {
          background-color: #4CAF50;
          color: white;
          padding: 12px 24px;
          font-size: 16px;
          border: none;
          border-radius: 8px;
          cursor: pointer;
          transition: background-color 0.3s ease, transform 0.2s ease;
          margin-left: 10px;
        }

        .feedback-btn:hover {
          background-color: #45a049;
          transform: scale(1.05);
        }

        .feedback-btn:active {
          transform: scale(1);
        }

        /* Feedback Display Styles */
        .feedback-display {
          background-color: var(--card);
          border-radius: 12px;
          padding: 20px;
          margin-top: 20px;
          position: relative;
          border: 1px solid var(--muted);
        }

        .close-btn {
          position: absolute;
          top: 10px;
          right: 15px;
          background: #f97583;
          color: white;
          border: none;
          border-radius: 50%;
          width: 30px;
          height: 30px;
          cursor: pointer;
          font-size: 16px;
          font-weight: bold;
          transition: background-color 0.3s;
        }

        .close-btn:hover {
          background-color: #e5534b;
        }

        .feedback-display h3 {
          color: var(--primary);
          margin-bottom: 20px;
          text-align: center;
        }

        .feedback-item {
          background-color: var(--muted);
          border-radius: 8px;
          padding: 15px;
          margin-bottom: 15px;
          border-left: 4px solid var(--primary);
        }

        .feedback-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 10px;
        }

        .feedback-rating {
          color: gold;
          font-size: 1.2rem;
        }

        .feedback-type {
          background-color: var(--primary);
          color: var(--background);
          padding: 4px 8px;
          border-radius: 4px;
          font-size: 0.8rem;
          font-weight: bold;
          text-transform: uppercase;
        }

        .feedback-text {
          margin-bottom: 10px;
          line-height: 1.5;
        }

        .feedback-meta {
          display: flex;
          gap: 15px;
          font-size: 0.9rem;
          color: var(--muted-foreground);
        }

        /* Responsive Styles */
        @media (max-width: 1024px) {
          .hero {
            flex-direction: column;
          }

          .hero-content {
            padding: 40px 20px;
            max-width: 100%;
          }

          .hero-images {
            flex-direction: column;
            align-items: center;
          }

          .hero-image {
            width: 80%;
            height: 200px;
          }

          .hero h1 {
            font-size: 2.5rem;
          }
        }

        @media (max-width: 768px) {
          header {
            padding: 15px;
          }

          .header-content {
            flex-direction: column;
          }

          .logo {
            margin-bottom: 15px;
          }

          .nav {
            flex-wrap: wrap;
            justify-content: center;
          }

          .nav li {
            margin: 5px;
          }

          .nav a {
            padding: 8px 15px;
            font-size: 0.9rem;
          }

          .hero-buttons {
            flex-direction: column;
          }

          .button {
            width: 100%;
            text-align: center;
          }

          .pricing-plans {
            grid-template-columns: 1fr;
          }

          .download-options {
            flex-direction: column;
            align-items: center;
          }

          .download-btn {
            width: 100%;
            justify-content: center;
          }

          .feedback-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 10px;
          }

          .feedback-meta {
            flex-direction: column;
            gap: 5px;
          }
        }

        /* Payment Display Styles */
        .payment-display {
            background-color: var(--card);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            position: relative;
            border: 1px solid var(--muted);
        }

        .payment-display h3 {
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
        }

        .payment-item {
            background-color: var(--muted);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid var(--primary);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .payment-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 230, 172, 0.2);
        }

        .payment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .payment-plan {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .plan-icon {
            font-size: 1.5rem;
        }

        .plan-name {
            font-weight: bold;
            color: var(--primary);
            font-size: 1.1rem;
        }

        .payment-amount {
            background-color: var(--primary);
            color: var(--background);
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .payment-details {
            margin-bottom: 15px;
        }

        .payment-detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(139, 148, 158, 0.2);
        }

        .payment-detail-row:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .detail-label {
            color: var(--muted-foreground);
            font-weight: 500;
        }

        .detail-value {
            color: var(--foreground);
            font-weight: 600;
        }

        .payment-meta {
            display: flex;
            gap: 15px;
            font-size: 0.9rem;
            color: var(--muted-foreground);
            padding-top: 10px;
            border-top: 1px solid rgba(139, 148, 158, 0.2);
        }

        /* Responsive adjustments for payment display */
        @media (max-width: 768px) {
            .payment-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .payment-detail-row {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }
            
            .payment-meta {
                flex-direction: column;
                gap: 5px;
            }
        }

        

    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo">Salient Object Detection</div>
            <ul class="nav">
                <li><a href="#home" class="active">Home</a></li>
                <li><a href="#detection">Detection</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#payment">Payment</a></li>
                <li><a href="#feedback">Feedback</a></li>
                <li><a href="/logout">Logout</a></li>
            </ul>
        </div>
    </header>

    <div id="home" class="section" >
        <main class="hero">
            <div class="hero-content" >
                <h1>
                    Welcome to
                    <span>Salient Object Detection</span>
                </h1>
                <p>
                    Detect and analyze the most important parts of your images with ease. Our advanced AI-powered system accurately identifies and highlights key objects, making it perfect for content creators, designers, and developers.
                </p>
                <div class="hero-buttons">
                    <a href="#detection" class="button button-primary">Try Detection</a>
                    <a href="#about" class="button button-secondary">Learn More</a>
                </div>
            </div>
            <div class="hero-images">
                <div class="hero-image">
                    <img src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/ILSVRC2012_test_00005309_selfmask.jpg-x5ZwMNznb6nUbSPMeTbQbNZfY0pTJm.jpeg" alt="Yellow butterfly on pink flower">
                    <div class="hero-image-overlay"></div>
                </div>
                <div class="hero-image">
                  <img src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/ILSVRC2012_test_00005309_selfmask.jpg-x5ZwMNznb6nUbSPMeTbQbNZfY0pTJm.jpeg" alt="Yellow butterfly on pink flower">
                  <div class="hero-image-overlay"></div>
              </div>
                <div class="hero-image">
                    <img src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/ILSVRC2012_test_00005309_selfmask.jpg-x5ZwMNznb6nUbSPMeTbQbNZfY0pTJm.jpeg" alt="Yellow butterfly on pink flower">
                    <div class="hero-image-overlay"></div>
                </div>
            </div>
        </main>
    </div>


    <div id="detection" class="section">
        <div class="container">
            <div class="panel" id="uploadSection">
                <h2>Upload Image</h2>
                <form id="uploadForm" enctype="multipart/form-data">
                    <div class="file-upload">
                        <input type="file" id="file" name="file" accept="image/*" required>
                        <label for="file">
                            <div class="upload-icon">📁</div>
                            <div id="file-name">No file selected</div>
                            <div id="file-size">Drag & drop or click to select</div>
                        </label>
                    </div>
                    <button type="submit" id="uploadButton">Upload Image</button>
                </form>
                <div class="progress-container" style="display: none;">
                    <div class="progress-bar" id="uploadProgress">0%</div>
                </div>
                <div id="statusMessage"></div>
            </div>

            <div class="panel" id="resultsPanel" style="display: none;">
                <h2>Detection Results</h2>
                
                <div id="cacheStatus"></div>
                
                <div id="results">
                    <div class="result-item">
                        <h3>Original Image</h3>
                        <img id="originalImage" src="/placeholder.svg" alt="Original Image">
                    </div>
                    <div class="result-item">
                        <h3>AI Detection Mask</h3>
                        <img id="maskImage" src="/placeholder.svg" alt="AI Detection Mask">
                    </div>
                </div>



                <div class="download-section">
                    <div class="download-panel">
                        <h3>Download Results</h3>
                        <div class="download-options">
                            <select id="downloadFormat" class="download-btn">
                              <option value="">Select Format...</option>
                              <option value="png">PNG</option>
                              <option value="jpeg">JPG</option>
                              <option value="pdf">PDF</option>
                            </select>
                          <button id="downloadTrigger" class="download-btn">Download</button>
                          <button id="resultFeedbackBtn" class="feedback-btn">Result Feedback</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="about" class="section">
        <div class="container">
            <div class="panel">
                <h2>About Salient Object Detection</h2>
                <div class="about-content">
                    <div class="about-section">
                        <h3>Our Mission</h3>
                        <p>
                            At Salient Object Detection, our mission is to provide cutting-edge computer vision solutions that help users identify and extract the most important elements in their images. We believe in making advanced AI technology accessible to everyone, from professional designers to casual content creators.
                        </p>
                    </div>

                    <div class="about-section">
                        <h3>What is Salient Object Detection?</h3>
                        <p>
                            Salient object detection is a computer vision technique that identifies the most visually distinctive objects in an image. It mimics the human visual system's ability to quickly focus on important elements within a scene. Our technology uses state-of-the-art deep learning models to accurately identify these salient objects and create precise masks and heatmaps.
                        </p>
                    </div>

                    <div class="about-section">
                        <h3>Applications</h3>
                        <p>
                            Our salient object detection technology has numerous practical applications:
                        </p>
                        <ul class="about-list">
                            <li><strong>Content Creation:</strong> Automatically focus on the most important elements in your images for more effective visual storytelling.</li>
                            <li><strong>Image Editing:</strong> Quickly isolate objects for editing, removing backgrounds, or applying effects.</li>
                            <li><strong>UX Research:</strong> Understand what elements of your designs naturally draw user attention.</li>
                            <li><strong>E-commerce:</strong> Highlight products in catalog images to improve customer engagement.</li>
                            <li><strong>Medical Imaging:</strong> Assist in identifying regions of interest in medical scans.</li>
                            <li><strong>Autonomous Systems:</strong> Help robots and vehicles identify important objects in their environment.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="payment" class="section">
        <div class="container">
            <div class="panel">
                <h2>Pricing Plans</h2>
                <div class="payment-content">
                    <div class="payment-intro">
                        <p>Choose the plan that best fits your needs. All plans include access to our core salient object detection technology.</p>
                    </div>

                    <div class="pricing-plans">
                        <div class="pricing-card">
                            <div class="pricing-header">
                              
                            <div class="plan-card" data-plan="basic" style="background-color: rgba(115, 92, 92, 0.264);">
                              <input type="radio" name="planType" value="basic" id="planBasic">
                              <span class="plan-icon">🥇</span>
                              <div class="plan-name">Basic</div>
                              <div class="plan-price">$9.99/month</div>
                            </div>
                      
                                <h3>Basic</h3>
                                <p>Perfect for individuals and small projects</p>
                                <div class="pricing-price">
                                    <span class="price">$9.99</span>
                                    <span class="period">/month</span>
                                </div>
                            </div>
                            <ul class="pricing-features">
                                <li>100 image detections per month</li>
                                <li>Standard resolution support</li>
                                <li>Basic mask and heatmap generation</li>
                                <li>24-hour result storage</li>
                                <li>Email support</li>
                            </ul>
                            <button class="pricing-button primary">Get Started</button>
                        </div>

                        <div class="pricing-card popular">
                            <div class="popular-badge">Most Popular</div>
                            <div class="pricing-header">

                            <div class="plan-card" data-plan="pro" style="background-color: rgba(115, 92, 92, 0.264);">
                            <input type="radio" name="planType" value="pro" id="planPro">
                            <span class="plan-icon">🥈</span>
                            <div class="plan-name">Pro</div>
                            <div class="plan-price">$24.99/month</div>
                        </div>
            
                                <h3>Pro</h3>
                                <p>Ideal for professionals and growing businesses</p>
                                <div class="pricing-price">
                                    <span class="price">$29.99</span>
                                    <span class="period">/month</span>
                                </div>
                            </div>
                            <ul class="pricing-features">
                                <li>500 image detections per month</li>
                                <li>High resolution support</li>
                                <li>Advanced mask and heatmap generation</li>
                                <li>7-day result storage</li>
                                <li>Priority email support</li>
                                <li>Batch processing</li>
                                <li>API access</li>
                            </ul>
                            <button class="pricing-button primary">Get Started</button>
                        </div>
              
                        <div class="pricing-card">
                            <div class="pricing-header">
                            <div class="plan-card" data-plan="enterprise" style="background-color: rgba(115, 92, 92, 0.264);">
                              <input type="radio" name="planType" value="enterprise" id="planEnterprise">
                              <span class="plan-icon">🥉</span>
                              <div class="plan-name">Enterprise</div>
                              <div class="plan-price">$99.99/month</div>
                            </div>

                                <h3>Enterprise</h3>
                                <p>For organizations with high-volume needs</p>
                                <div class="pricing-price">
                                    <span class="price">$99.99</span>
                                    <span class="period">/month</span>
                                </div>
                            </div>
                            <ul class="pricing-features">
                                <li>1500 image detections</li>
                                <li>Ultra-high resolution support</li>
                                <li>Premium mask and heatmap generation</li>
                                <li>30-day result storage</li>
                                <li>24/7 priority support</li>
                                <li>Advanced batch processing</li>
                                <li>Full API access with higher rate limits</li>
                                <li>Custom integration assistance</li>
                                <li>Dedicated account manager</li>
                            </ul>
                            <button class="pricing-button primary">Get Started</button>
                        </div>
                    </div>
                </div>
                <div class="form-group text-center" style="margin-top: 10px;">
                    <button type="button" class="view-btn" id="viewPaymentBtn">
                        View Payment Info
                    </button>
                </div>

                <!-- Payment Info will appear here -->
                <div id="paymentResults" style="position: relative; margin-top: 20px;"></div>

            </div>
        </div>
    </div>

    <div id="feedback" class="section">
        <div class="container">
            <div class="panel">
                <h2>Share Your Feedback</h2>
                <div class="feedback-content">
                    <div class="feedback-intro">
                        <p>We value your opinion! Please share your thoughts and experiences with our salient object detection service. Your feedback helps us improve and better serve your needs.</p>
                    </div>

                    <form class="feedback-form" id="feedbackForm">
                        <div class="form-group">
                            <label>How would you rate your experience?</label>
                            <div class="rating">
                                <button type="button" class="star-btn" data-rating="1">★</button>
                                <button type="button" class="star-btn" data-rating="2">★</button>
                                <button type="button" class="star-btn" data-rating="3">★</button>
                                <button type="button" class="star-btn" data-rating="4">★</button>
                                <button type="button" class="star-btn" data-rating="5">★</button>
                            </div>
                            <input type="hidden" id="rating" name="rating" value="0">
                        </div>

                    <div class="form-group">
                        <label for="Feedback_Type">Type of Feedback</label>
                        <select id="Feedback_Type" name="Feedback_Type" required>
                            <option value="" style="color: black;">Select feedback type</option>
                            <option value="general" style="color: black;">General Feedback</option>
                            <option value="result" style="color: black;">Result Feedback</option>
                        </select>
                    </div>

                        <div class="form-group">
                            <label for="feedback">Feedback Text</label>
                            <textarea id="Feedback_Text" name="Feedback_Text" rows="6" placeholder="Please share your thoughts, suggestions, or report any issues you've encountered..." required></textarea>
                        </div>

                        <!-- Hidden field for result_id -->
                        <input type="hidden" id="result_id" name="result_id" value="">

                        <div class="form-submit">
                            <button type="submit" class="submit-button">Submit Feedback</button>
                        </div>

                        <div class="form-group text-center" style="margin-top: 20px;">
                          <button type="button" class="view-btn" id="viewFeedbackBtn">
                                 View My Feedback
                            </button>
                        </div>

                    </form>

                    <!-- Feedback display container -->
                    <div id="feedbackContainer"></div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="footer-grid">
                <div class="footer-section">
                    <h3>Salient Object Detection</h3>
                    <p>Advanced AI-powered system for detecting and highlighting key objects in images.</p>
                </div>
                
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="#home">Home</a></li>
                        <li><a href="#detection">Detection</a></li>
                        <li><a href="#about">About</a></li>
                        <li><a href="#payment">Payment</a></li>
                        <li><a href="#feedback">Feedback</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>Contact</h3>
                    <p>Email: info@salientdetection.com</p>
                    <p>Phone: +1 (555) 123-4567</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; <span id="current-year"></span> Salient Object Detection. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Global variables
        let currentResultId = null;

        document.addEventListener('DOMContentLoaded', function() {
            // Set current year in footer
            document.getElementById('current-year').textContent = new Date().getFullYear();
            
            // File upload handling
            const fileInput = document.getElementById('file');
            const fileName = document.getElementById('file-name');
            const fileSize = document.getElementById('file-size');
            const uploadForm = document.getElementById('uploadForm');
            const progressContainer = document.querySelector('.progress-container');
            const uploadProgress = document.getElementById('uploadProgress');
            const statusMessage = document.getElementById('statusMessage');
            const resultsPanel = document.getElementById('resultsPanel');
            const loadingOverlay = document.getElementById('loadingOverlay');
            
            function formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }
            
            if (fileInput) {
                fileInput.addEventListener('change', function() {
                    if (this.files && this.files[0]) {
                        const file = this.files[0];
                        fileName.textContent = file.name;
                        fileSize.textContent = formatFileSize(file.size);
                    } else {
                        fileName.textContent = 'No file selected';
                        fileSize.textContent = 'Drag & drop or click to select';
                    }
                });
            }
            

            // Upload form submission
            // Upload form submission
// Upload form submission
// Upload form submission
if (uploadForm) {
    uploadForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const fileInput = document.getElementById('file');
        if (!fileInput.files[0]) {
            alert('Please select a file first');
            return;
        }

        // Show progress bar
        progressContainer.style.display = 'block';
        uploadProgress.style.width = '0%';
        uploadProgress.textContent = '0%';
        statusMessage.textContent = 'Processing your upload...';
        statusMessage.style.color = '';

        const formData = new FormData();
        formData.append('image', fileInput.files[0]);

        try {
            // First save image info to database
            const saveResponse = await fetch('/save_image_info', {
                method: 'POST',
                body: formData
            });

            // First check if response is ok
            if (!saveResponse.ok) {
                // Try to parse error as JSON, fallback to text if not JSON
                let errorData;
                try {
                    errorData = await saveResponse.clone().json();
                    throw new Error(errorData.message || errorData.error || 'Upload failed');
                } catch (parseError) {
                    const text = await saveResponse.text();
                    console.error('Server returned HTML instead of JSON:', text.substring(0, 500));
                    alert('Server error: ' + text.substring(0, 200)); // Show first 200 chars for debugging
                    throw new Error('Server error - please try again or contact support');
                }
            }

            const saveData = await saveResponse.json();
            
            if (saveData.success) {
                statusMessage.textContent = 'Image saved successfully! Now processing with AI...';
                statusMessage.style.color = 'var(--primary)';
                
                // Store current result ID for feedback
                currentResultId = saveData.result_id;
                document.getElementById('result_id').value = currentResultId;
                
                // Now process with AI model
                const aiFormData = new FormData();
                aiFormData.append('image', fileInput.files[0]);
                
                const aiResponse = await fetch('/predict', {
  method: 'POST',
  body: aiFormData
});

let aiData;
if (!aiResponse.ok) {
  // Try to parse error as JSON, fallback to text if not JSON
  try {
    const errorData = await aiResponse.clone().json();
    throw new Error(errorData.error || errorData.message || 'AI prediction failed');
  } catch (parseError) {
    // If JSON parsing fails, it's likely an HTML error page
    const text = await aiResponse.text();
    console.error('AI Server returned HTML instead of JSON:', text.substring(0, 200));
    throw new Error('AI processing error - please try again or contact support');
  }
} else {
  aiData = await aiResponse.json();
}
                
                // Show results
                if (aiData && aiData.data) {
                  document.getElementById('originalImage').src = aiData.data.original;
                  document.getElementById('maskImage').src = aiData.data.mask;
                } else {
                  statusMessage.textContent = 'AI returned no results.';
                }
                resultsPanel.style.display = 'block';

                // Show remaining uploads/trials message from backend
                let trialMsg = saveData.message || '';
                let trialMsgElem = document.getElementById('trialMsg');
                if (!trialMsgElem) {
                  trialMsgElem = document.createElement('div');
                  trialMsgElem.id = 'trialMsg';
                  trialMsgElem.style.marginTop = '20px';
                  trialMsgElem.style.textAlign = 'center';
                  trialMsgElem.style.fontWeight = 'bold';
                  trialMsgElem.style.color = 'var(--primary)';
                  resultsPanel.parentNode.insertBefore(trialMsgElem, resultsPanel.nextSibling);
                }
                trialMsgElem.textContent = trialMsg;
                
                statusMessage.textContent = 'AI processing completed successfully!';
            } else {
                throw new Error(saveData.message || 'Upload failed');
            }
        } catch (error) {
            statusMessage.textContent = error.message;
            statusMessage.style.color = '#f97583';
            
            if (error.message.includes('maximum free uploads') || 
                error.message.includes('subscription has expired')) {
                if (confirm(error.message + '\n\nWould you like to subscribe now?')) {
                    window.location.href = '/#payment';
                }
            }
        } finally {
            progressContainer.style.display = 'none';
        }
    });
}

            // Star rating functionality
            const starButtons = document.querySelectorAll('.star-btn');
            const ratingInput = document.getElementById('rating');
            
            starButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const rating = this.getAttribute('data-rating');
                    ratingInput.value = rating;
                    
                    // Update star appearance
                    starButtons.forEach(btn => {
                        btn.classList.toggle('active', btn.getAttribute('data-rating') <= rating);
                    });
                });
            });

            // Feedback form submission
            const feedbackForm = document.getElementById('feedbackForm');
            if (feedbackForm) {
                feedbackForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    // Basic validation
                    if (ratingInput.value === "0") {
                        alert("Please select a star rating");
                        return;
                    }
                    
                    // Get form data
                    const formData = new FormData(feedbackForm);
                    
                    // Show loading state
                    const submitBtn = feedbackForm.querySelector('.submit-button');
                    const originalText = submitBtn.textContent;
                    submitBtn.disabled = true;
                    submitBtn.textContent = "Submitting...";
                    
                    try {
                        const response = await fetch('/submit_feedback', {
                            method: 'POST',
                            body: formData
                        });
                        
                        if (!response.ok) {
                            const errorData = await response.clone().json();
                            throw new Error(errorData.message || 'Server error');
                        }
                        
                        const data = await response.json();
                        
                        if (data.success) {
                            alert("Feedback submitted successfully!");
                            feedbackForm.reset();
                            starButtons.forEach(btn => btn.classList.remove('active'));
                            ratingInput.value = '0';
                            
                            // Clear any displayed feedback to refresh it
                            const feedbackContainer = document.getElementById('feedbackContainer');
                            feedbackContainer.innerHTML = '';
                        } else {
                            throw new Error(data.message || 'Submission failed');
                        }
                    } catch (error) {
                        console.error('Error:', error);
                        alert("Error submitting feedback: " + error.message);
                    } finally {
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                    }
                });
            }

            // View feedback button
            const viewFeedbackBtn = document.getElementById('viewFeedbackBtn');
            if (viewFeedbackBtn) {
                viewFeedbackBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    fetch('/get_feedback')
                        .then(response => {
                            if (!response.ok) {
                                return response.json().then(err => {
                                    throw new Error(err.message || 'Failed to fetch feedback');
                                });
                            }
                            return response.json();
                        })
                        .then(data => {
                            if (data.success) {
                                displayFeedback(data.data);
                            } else {
                                throw new Error(data.message || 'No feedback found');
                            }
                        })
                        .catch(error => {
                            alert('Error: ' + error.message);
                            console.error('Feedback fetch error:', error);
                        });
                });
            }

            // Function to display feedback
            function displayFeedback(feedbackData) {
                const feedbackContainer = document.getElementById('feedbackContainer');
                
                // Clear existing content
                feedbackContainer.innerHTML = '';
                
                if (!feedbackData || feedbackData.length === 0) {
                    feedbackContainer.innerHTML = `
                        <div class="feedback-display">
                            <button class="close-btn" onclick="this.parentElement.remove()">✖</button>
                            <h3>Your Feedback History</h3>
                            <p style="text-align: center; color: var(--muted-foreground);">No feedback submitted yet.</p>
                        </div>
                    `;
                    return;
                }

                // Create feedback display container
                const displayDiv = document.createElement('div');
                displayDiv.className = 'feedback-display';
                
                // Add close button
                const closeBtn = document.createElement('button');
                closeBtn.className = 'close-btn';
                closeBtn.innerHTML = '✖';
                closeBtn.onclick = () => feedbackContainer.innerHTML = '';
                displayDiv.appendChild(closeBtn);
                
                // Add title
                const title = document.createElement('h3');
                title.textContent = 'Your Feedback History';
                displayDiv.appendChild(title);
                
                // Add feedback items
                feedbackData.forEach(feedback => {
                    const feedbackItem = document.createElement('div');
                    feedbackItem.className = 'feedback-item';
                    
                    // Create star rating display
                    const stars = '★'.repeat(feedback.Rating || 0) + '☆'.repeat(5 - (feedback.Rating || 0));
                    
                    feedbackItem.innerHTML = `
                        <div class="feedback-header">
                            <div class="feedback-rating">${stars} (${feedback.Rating}/5)</div>
                            <div class="feedback-type">${feedback.Feedback_Type}</div>
                        </div>
                        <div class="feedback-text">${feedback.Feedback_Text}</div>
                        <div class="feedback-meta">
                            <span>ID: ${feedback.Feedback_ID}</span>
                            <span>User: ${feedback.User_ID}</span>
                            ${feedback.Result_ID ? `<span>Result: ${feedback.Result_ID}</span>` : ''}
                        </div>
                    `;
                    
                    displayDiv.appendChild(feedbackItem);
                });
                
                feedbackContainer.appendChild(displayDiv);
            }

            // Result feedback button
            const resultFeedbackBtn = document.getElementById('resultFeedbackBtn');
            if (resultFeedbackBtn) {
                resultFeedbackBtn.addEventListener('click', function() {
                    // Scroll to feedback section
                    document.querySelector('a[href="#feedback"]').click();
                    
                    // Set feedback type to "result"
                    const feedbackType = document.getElementById('Feedback_Type');
                    feedbackType.value = 'result';
                    
                    // Focus on feedback text
                    document.getElementById('Feedback_Text').focus();
                });
            }

            // Plan selection handling
            document.querySelectorAll('.plan-card').forEach(card => {
                card.addEventListener('click', function() {
                    document.querySelectorAll('.plan-card').forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    this.querySelector('input[type="radio"]').checked = true;
                });
            });

            // Payment functionality
            async function startPayment(plan) {
                try {
                    const res = await fetch('/create-checkout-session', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ plan })
                    });
                    const data = await res.json();
                    if (data.checkout_url) {
                        window.location.href = data.checkout_url;
                    } else {
                        alert("Error creating checkout session: " + (data.error || 'Unknown error'));
                    }
                } catch (error) {
                    console.error('Payment error:', error);
                    alert("An error occurred while processing your payment");
                }
            }

            document.querySelectorAll('.pricing-button').forEach(button => {
                button.addEventListener('click', function () {
                    const card = this.closest('.pricing-card');
                    let plan = 'basic';
                    if (card.classList.contains('popular')) plan = 'pro';
                    else if (card.querySelector('h3').textContent.includes('Enterprise')) plan = 'enterprise';
                    startPayment(plan);
                });
            });

            // View payment info
            const viewPaymentBtn = document.getElementById('viewPaymentBtn');
            if (viewPaymentBtn) {
                viewPaymentBtn.addEventListener('click', function () {
                    fetch('/get_payment_info')
                        .then(response => response.json())
                        .then(data => {
                            if (data.success) {
                                displayPaymentInfo(data.data);
                            } else {
                                throw new Error(data.message || 'No payment info found');
                            }
                        })
                        .catch(error => {
                            document.getElementById('paymentResults').innerHTML = `<p style="color:red;">Error: ${error.message}</p>`;
                        });
                });
            }

            function displayPaymentInfo(paymentData) {
                const container = document.getElementById('paymentResults');
                container.innerHTML = '';

                if (!paymentData || paymentData.length === 0) {
                    container.innerHTML = `
                        <div class="payment-display">
                            <button class="close-btn" onclick="this.parentElement.remove()">✖</button>
                            <h3>Your Payment History</h3>
                            <p style="text-align: center; color: var(--muted-foreground);">No payment records found.</p>
                        </div>
                    `;
                    return;
                }

                // Create payment display container
                const displayDiv = document.createElement('div');
                displayDiv.className = 'payment-display';
                
                // Add close button
                const closeBtn = document.createElement('button');
                closeBtn.className = 'close-btn';
                closeBtn.innerHTML = '✖';
                closeBtn.onclick = () => container.innerHTML = '';
                displayDiv.appendChild(closeBtn);
                
                // Add title
                const title = document.createElement('h3');
                title.textContent = 'Your Payment History';
                displayDiv.appendChild(title);
                
                // Add payment items
                paymentData.forEach(payment => {
                    const paymentItem = document.createElement('div');
                    paymentItem.className = 'payment-item';
                    
                    // Determine plan icon and color
                    let planIcon = '💳';
                    let planColor = 'var(--primary)';
                    if (payment.Plan_Type === 'basic') {
                        planIcon = '🥇';
                        planColor = '#ffd700';
                    } else if (payment.Plan_Type === 'pro') {
                        planIcon = '🥈';
                        planColor = '#c0c0c0';
                    } else if (payment.Plan_Type === 'enterprise') {
                        planIcon = '🥉';
                        planColor = '#cd7f32';
                    }
                    
                    paymentItem.innerHTML = `
                        <div class="payment-header">
                            <div class="payment-plan">
                                <span class="plan-icon">${planIcon}</span>
                                <span class="plan-name">${payment.Plan_Type.charAt(0).toUpperCase() + payment.Plan_Type.slice(1)} Plan</span>
                            </div>
                            <div class="payment-amount">$${payment.Amount_Paid}</div>
                        </div>
                        <div class="payment-details">
                            <div class="payment-detail-row">
                                <span class="detail-label">Upload Limit:</span>
                                <span class="detail-value">${payment.Upload_Limit === -1 ? 'Unlimited' : payment.Upload_Limit + ' images'}</span>
                            </div>
                            <div class="payment-detail-row">
                                <span class="detail-label">Duration:</span>
                                <span class="detail-value">${payment.Start_Date} to ${payment.End_Date}</span>
                            </div>
                        </div>
                        <div class="payment-meta">
                            <span>Subscription ID: ${payment.Subscription_ID}</span>
                        </div>
                    `;
                    
                    displayDiv.appendChild(paymentItem);
                });
                
                container.appendChild(displayDiv);
            }

            // Smooth scrolling for navigation
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth'
                        });
                    }
                });
            });
            
            // Update active navigation link on scroll
            window.addEventListener('scroll', () => {
                let current = '';
                document.querySelectorAll('.section').forEach(section => {
                    const sectionTop = section.offsetTop;
                    if (pageYOffset >= sectionTop - 100) {
                        current = section.getAttribute('id');
                    }
                });
                
                document.querySelectorAll('.nav a').forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === '#' + current) {
                        link.classList.add('active');
                    }
                });
            });
        });




document.getElementById('uploadForm').addEventListener('submit', function(e) {
  e.preventDefault();

  const formData = new FormData();
  const fileInput = document.getElementById('file');
  const file = fileInput.files[0];

  if (!file) {
    alert("Please select an image.");
    return;
  }

  formData.append('image', file);

  fetch('/upload', {
    method: 'POST',
    body: formData
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      // Display original image
      document.getElementById('originalImage').src = data.original_image_url;

      // Display saliency map
      document.getElementById('saliencyMap').src = data.saliency_map_url;

      // Show results container
      document.getElementById('resultsContainer').style.display = 'flex';
    } else {
      alert("Error uploading image.");
    }
  })
  // .catch(error => {
  //   console.error('Error:', error);
  //   alert("An error occurred during upload.");
  // });
});





document.addEventListener('DOMContentLoaded', function() {
    // Get all elements
    const uploadForm = document.getElementById('uploadForm');
    const fileInput = document.getElementById('file');
    const uploadButton = document.getElementById('uploadButton');
    const originalImage = document.getElementById('originalImage');
    const saliencyMapContainer = document.getElementById('saliencyMapContainer');
    const resultsPanel = document.getElementById('resultsPanel');
    const uploadSection = document.getElementById('uploadSection');

    // Handle file selection
    fileInput.addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
            // Show preview of selected file
            const reader = new FileReader();
            reader.onload = function(event) {
                originalImage.src = event.target.result;
            };
            reader.readAsDataURL(file);
        }
    });

    // Handle form submission
    uploadForm.addEventListener('submit', function(e) {
        e.preventDefault(); // This is the KEY LINE that prevents disappearance
        
        const file = fileInput.files[0];
        if (!file) {
            alert('Please select a file first');
            return;
        }

        uploadButton.disabled = true;
        
        const formData = new FormData();
        formData.append('image', file);

        // Simple and reliable fetch request
        fetch('/upload', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // PERMANENTLY show results
                uploadSection.style.display = 'none';
                resultsPanel.style.display = 'block';
                
                // PERMANENTLY display both images
                originalImage.src = data.original_image_url;
                saliencyMapContainer.innerHTML = `
                    <img src="${data.saliency_map_url}" 
                         alt="Saliency Map"
                         style="max-width:100%; border:2px solid blue;">
                `;
            } else {
                throw new Error(data.error || 'Upload failed');
            }
        })
        .catch(error => {
            alert(error.message);
        })
        .finally(() => {
            uploadButton.disabled = false;
        });
    });

});

document.getElementById("downloadTrigger").addEventListener("click", function () {
    const format = document.getElementById("downloadFormat").value;
    const originalImage = document.getElementById("originalImage");
    const maskImage = document.getElementById("maskImage");

    if (!format) {
        alert("Please select a format.");
        return;
    }

    if (!originalImage || !originalImage.src || originalImage.src.includes('placeholder')) {
        alert("No valid image to download.");
        return;
    }

    if (format === 'pdf') {
        // Check if jsPDF is loaded
        if (typeof window.jspdf === 'undefined') {
            alert("PDF library not loaded. Please refresh the page and try again.");
            return;
        }

        const { jsPDF } = window.jspdf;
        
        // Create PDF with both original and mask images
        const pdf = new jsPDF('p', 'mm', 'a4');
        const pageWidth = pdf.internal.pageSize.getWidth();
        const pageHeight = pdf.internal.pageSize.getHeight();
        
        // Add title
        pdf.setFontSize(16);
        pdf.text('Salient Object Detection Results', pageWidth/2, 20, { align: 'center' });
        
        // Add original image
        pdf.setFontSize(12);
        pdf.text('Original Image:', 20, 40);
        
        const img1 = new Image();
        img1.crossOrigin = "Anonymous";
        img1.onload = function() {
            const canvas1 = document.createElement('canvas');
            const ctx1 = canvas1.getContext('2d');
            canvas1.width = img1.width;
            canvas1.height = img1.height;
            ctx1.drawImage(img1, 0, 0);
            
            const imgData1 = canvas1.toDataURL('image/jpeg', 0.8);
            const imgWidth1 = pageWidth - 40;
            const imgHeight1 = (img1.height * imgWidth1) / img1.width;
            
            pdf.addImage(imgData1, 'JPEG', 20, 50, imgWidth1, imgHeight1);
            
            // Add mask image if available
            if (maskImage && maskImage.src && !maskImage.src.includes('placeholder')) {
                const img2 = new Image();
                img2.crossOrigin = "Anonymous";
                img2.onload = function() {
                    const canvas2 = document.createElement('canvas');
                    const ctx2 = canvas2.getContext('2d');
                    canvas2.width = img2.width;
                    canvas2.height = img2.height;
                    ctx2.drawImage(img2, 0, 0);
                    
                    const imgData2 = canvas2.toDataURL('image/jpeg', 0.8);
                    const imgWidth2 = pageWidth - 40;
                    const imgHeight2 = (img2.height * imgWidth2) / img2.width;
                    
                    // Check if we need a new page
                    const currentY = 50 + imgHeight1 + 20;
                    if (currentY + imgHeight2 > pageHeight - 30) {
                        pdf.addPage();
                        pdf.text('AI Detection Mask:', 20, 20);
                        pdf.addImage(imgData2, 'JPEG', 20, 30, imgWidth2, imgHeight2);
                    } else {
                        pdf.text('AI Detection Mask:', 20, currentY);
                        pdf.addImage(imgData2, 'JPEG', 20, currentY + 10, imgWidth2, imgHeight2);
                    }
                    
                    // Add timestamp
                    pdf.setFontSize(10);
                    pdf.text(`Generated on: ${new Date().toLocaleString()}`, 20, pageHeight - 10);
                    
                    pdf.save("salient_object_detection_results.pdf");
                };
                img2.src = maskImage.src;
            } else {
                // Add timestamp
                pdf.setFontSize(10);
                pdf.text(`Generated on: ${new Date().toLocaleString()}`, 20, pageHeight - 10);
                
                pdf.save("salient_object_detection_results.pdf");
            }
        };
        img1.src = originalImage.src;
        
    } else {
        // Handle PNG and JPEG downloads - Download the mask/result image
        if (!maskImage || !maskImage.src || maskImage.src.includes('placeholder')) {
            alert("No detection result available to download.");
            return;
        }
        
        const canvas = document.createElement("canvas");
        const ctx = canvas.getContext("2d");
        const img = new Image();
        img.crossOrigin = "Anonymous";

        img.onload = function () {
            canvas.width = img.width;
            canvas.height = img.height;
            ctx.drawImage(img, 0, 0);

            const mimeType = format === 'jpeg' ? 'image/jpeg' : 'image/png';
            const link = document.createElement('a');
            link.download = `ai_detection_mask.${format}`;
            link.href = canvas.toDataURL(mimeType);
            link.click();
        };

        img.src = maskImage.src;
    }
});


    </script>
</body>
</html>
